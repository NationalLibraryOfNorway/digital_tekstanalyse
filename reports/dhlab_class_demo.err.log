Traceback (most recent call last):
  File "/home/larsm/mambaforge/envs/jupyterbook/lib/python3.11/site-packages/jupyter_cache/executors/utils.py", line 58, in single_nb_execution
    executenb(
  File "/home/larsm/mambaforge/envs/jupyterbook/lib/python3.11/site-packages/nbclient/client.py", line 1204, in execute
    return NotebookClient(nb=nb, resources=resources, km=km, **kwargs).execute()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/larsm/mambaforge/envs/jupyterbook/lib/python3.11/site-packages/nbclient/util.py", line 84, in wrapped
    return just_run(coro(*args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/larsm/mambaforge/envs/jupyterbook/lib/python3.11/site-packages/nbclient/util.py", line 62, in just_run
    return loop.run_until_complete(coro)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/larsm/mambaforge/envs/jupyterbook/lib/python3.11/asyncio/base_events.py", line 653, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/larsm/mambaforge/envs/jupyterbook/lib/python3.11/site-packages/nbclient/client.py", line 663, in async_execute
    await self.async_execute_cell(
  File "/home/larsm/mambaforge/envs/jupyterbook/lib/python3.11/site-packages/nbclient/client.py", line 965, in async_execute_cell
    await self._check_raise_for_error(cell, cell_index, exec_reply)
  File "/home/larsm/mambaforge/envs/jupyterbook/lib/python3.11/site-packages/nbclient/client.py", line 862, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
dh.Ngram(["Dracula", "Frankenstein"], from_year=1880, to_year=2020)
------------------

[0;31m---------------------------------------------------------------------------[0m
[0;31mModuleNotFoundError[0m                       Traceback (most recent call last)
File [0;32m~/mambaforge/envs/jupyterbook/lib/python3.11/site-packages/pandas/compat/_optional.py:142[0m, in [0;36mimport_optional_dependency[0;34m(name, extra, errors, min_version)[0m
[1;32m    141[0m [38;5;28;01mtry[39;00m:
[0;32m--> 142[0m     module [38;5;241m=[39m [43mimportlib[49m[38;5;241;43m.[39;49m[43mimport_module[49m[43m([49m[43mname[49m[43m)[49m
[1;32m    143[0m [38;5;28;01mexcept[39;00m [38;5;167;01mImportError[39;00m:

File [0;32m~/mambaforge/envs/jupyterbook/lib/python3.11/importlib/__init__.py:126[0m, in [0;36mimport_module[0;34m(name, package)[0m
[1;32m    125[0m         level [38;5;241m+[39m[38;5;241m=[39m [38;5;241m1[39m
[0;32m--> 126[0m [38;5;28;01mreturn[39;00m [43m_bootstrap[49m[38;5;241;43m.[39;49m[43m_gcd_import[49m[43m([49m[43mname[49m[43m[[49m[43mlevel[49m[43m:[49m[43m][49m[43m,[49m[43m [49m[43mpackage[49m[43m,[49m[43m [49m[43mlevel[49m[43m)[49m

File [0;32m<frozen importlib._bootstrap>:1206[0m, in [0;36m_gcd_import[0;34m(name, package, level)[0m

File [0;32m<frozen importlib._bootstrap>:1178[0m, in [0;36m_find_and_load[0;34m(name, import_)[0m

File [0;32m<frozen importlib._bootstrap>:1128[0m, in [0;36m_find_and_load_unlocked[0;34m(name, import_)[0m

File [0;32m<frozen importlib._bootstrap>:241[0m, in [0;36m_call_with_frames_removed[0;34m(f, *args, **kwds)[0m

File [0;32m<frozen importlib._bootstrap>:1206[0m, in [0;36m_gcd_import[0;34m(name, package, level)[0m

File [0;32m<frozen importlib._bootstrap>:1178[0m, in [0;36m_find_and_load[0;34m(name, import_)[0m

File [0;32m<frozen importlib._bootstrap>:1142[0m, in [0;36m_find_and_load_unlocked[0;34m(name, import_)[0m

[0;31mModuleNotFoundError[0m: No module named 'scipy'

During handling of the above exception, another exception occurred:

[0;31mImportError[0m                               Traceback (most recent call last)
Cell [0;32mIn[14], line 1[0m
[0;32m----> 1[0m [43mdh[49m[38;5;241;43m.[39;49m[43mNgram[49m[43m([49m[43m[[49m[38;5;124;43m"[39;49m[38;5;124;43mDracula[39;49m[38;5;124;43m"[39;49m[43m,[49m[43m [49m[38;5;124;43m"[39;49m[38;5;124;43mFrankenstein[39;49m[38;5;124;43m"[39;49m[43m][49m[43m,[49m[43m [49m[43mfrom_year[49m[38;5;241;43m=[39;49m[38;5;241;43m1880[39;49m[43m,[49m[43m [49m[43mto_year[49m[38;5;241;43m=[39;49m[38;5;241;43m2020[39;49m[43m)[49m

File [0;32m~/mambaforge/envs/jupyterbook/lib/python3.11/site-packages/dhlab/ngram/ngram.py:65[0m, in [0;36mNgram.__init__[0;34m(self, words, from_year, to_year, doctype, mode, lang, **kwargs)[0m
[1;32m     61[0m [38;5;28;01mif[39;00m doctype [38;5;241m==[39m [38;5;124m"[39m[38;5;124mavis[39m[38;5;124m"[39m:
[1;32m     62[0m     lang [38;5;241m=[39m [38;5;28;01mNone[39;00m
[0;32m---> 65[0m ngrm [38;5;241m=[39m [43mnb_ngram[49m[43m([49m[43mterms[49m[38;5;241;43m=[39;49m[38;5;124;43m'[39;49m[38;5;124;43m, [39;49m[38;5;124;43m'[39;49m[38;5;241;43m.[39;49m[43mjoin[49m[43m([49m[43mwords[49m[43m)[49m[43m,[49m
[1;32m     66[0m [43m                [49m[43mcorpus[49m[38;5;241;43m=[39;49m[43mdoctype[49m[43m,[49m
[1;32m     67[0m [43m                [49m[43myears[49m[38;5;241;43m=[39;49m[43m([49m[43mfrom_year[49m[43m,[49m[43m [49m[43mto_year[49m[43m)[49m[43m,[49m
[1;32m     68[0m [43m                [49m[43msmooth[49m[43m [49m[38;5;241;43m=[39;49m[43m [49m[38;5;241;43m1[39;49m[43m,[49m[43m [49m[43mlang[49m[43m [49m[38;5;241;43m=[39;49m[43m [49m[43mlang[49m[43m,[49m
[1;32m     69[0m [43m                [49m[43mmode[49m[38;5;241;43m=[39;49m[43mmode[49m[43m)[49m
[1;32m     70[0m ngrm[38;5;241m.[39mindex [38;5;241m=[39m ngrm[38;5;241m.[39mindex[38;5;241m.[39mastype([38;5;28mstr[39m)
[1;32m     71[0m [38;5;28mself[39m[38;5;241m.[39mngram [38;5;241m=[39m ngrm

File [0;32m~/mambaforge/envs/jupyterbook/lib/python3.11/site-packages/dhlab/ngram/nb_ngram.py:29[0m, in [0;36mnb_ngram[0;34m(terms, corpus, smooth, years, mode, lang)[0m
[1;32m     26[0m [38;5;28;01mif[39;00m corpus [38;5;241m==[39m [38;5;124m"[39m[38;5;124mavis[39m[38;5;124m"[39m:
[1;32m     27[0m     lang [38;5;241m=[39m [38;5;28;01mNone[39;00m
[0;32m---> 29[0m df [38;5;241m=[39m [43mngram_conv[49m[43m([49m[43mget_ngram[49m[43m([49m[43mterms[49m[43m,[49m[43m [49m[43mcorpus[49m[38;5;241;43m=[39;49m[43mcorpus[49m[43m,[49m[43m [49m[43mlang[49m[43m [49m[38;5;241;43m=[39;49m[43m [49m[43mlang[49m[43m)[49m[43m,[49m[43m [49m[43msmooth[49m[38;5;241;43m=[39;49m[43msmooth[49m[43m,[49m[43m [49m[43myears[49m[38;5;241;43m=[39;49m[43myears[49m[43m,[49m[43m [49m[43mmode[49m[38;5;241;43m=[39;49m[43mmode[49m[43m)[49m
[1;32m     30[0m df[38;5;241m.[39mindex [38;5;241m=[39m df[38;5;241m.[39mindex[38;5;241m.[39mastype([38;5;28mint[39m)
[1;32m     31[0m [38;5;28;01mreturn[39;00m df[38;5;241m.[39msort_index()

File [0;32m~/mambaforge/envs/jupyterbook/lib/python3.11/site-packages/dhlab/ngram/nb_ngram.py:87[0m, in [0;36mngram_conv[0;34m(ngrams, smooth, years, mode)[0m
[1;32m     81[0m     [38;5;28;01mif[39;00m x [38;5;241m!=[39m []:
[1;32m     82[0m         ngc[x[[38;5;124m'[39m[38;5;124mkey[39m[38;5;124m'[39m]] \
[1;32m     83[0m         [38;5;241m=[39m \
[1;32m     84[0m         {z[[38;5;124m'[39m[38;5;124mx[39m[38;5;124m'[39m]:z[arg] [38;5;28;01mfor[39;00m z [38;5;129;01min[39;00m x[[38;5;124m'[39m[38;5;124mvalues[39m[38;5;124m'[39m] \
[1;32m     85[0m             [38;5;28;01mif[39;00m [38;5;28mint[39m(z[[38;5;124m'[39m[38;5;124mx[39m[38;5;124m'[39m]) [38;5;241m<[39m[38;5;241m=[39m [38;5;28mint[39m(years[[38;5;241m1[39m]) [38;5;129;01mand[39;00m [38;5;28mint[39m(z[[38;5;124m'[39m[38;5;124mx[39m[38;5;124m'[39m]) [38;5;241m>[39m[38;5;241m=[39m [38;5;28mint[39m(years[[38;5;241m0[39m])}
[0;32m---> 87[0m [38;5;28;01mreturn[39;00m [43mpd[49m[38;5;241;43m.[39;49m[43mDataFrame[49m[43m([49m[43mngc[49m[43m)[49m[38;5;241;43m.[39;49m[43mrolling[49m[43m([49m[43mwindow[49m[38;5;241;43m=[39;49m[43msmooth[49m[43m,[49m[43m [49m[43mwin_type[49m[38;5;241;43m=[39;49m[38;5;124;43m'[39;49m[38;5;124;43mtriang[39;49m[38;5;124;43m'[39;49m[43m)[49m[38;5;241m.[39mmean()

File [0;32m~/mambaforge/envs/jupyterbook/lib/python3.11/site-packages/pandas/core/generic.py:11697[0m, in [0;36mNDFrame.rolling[0;34m(self, window, min_periods, center, win_type, on, axis, closed, step, method)[0m
[1;32m  11694[0m axis [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39m_get_axis_number(axis)
[1;32m  11696[0m [38;5;28;01mif[39;00m win_type [38;5;129;01mis[39;00m [38;5;129;01mnot[39;00m [38;5;28;01mNone[39;00m:
[0;32m> 11697[0m     [38;5;28;01mreturn[39;00m [43mWindow[49m[43m([49m
[1;32m  11698[0m [43m        [49m[38;5;28;43mself[39;49m[43m,[49m
[1;32m  11699[0m [43m        [49m[43mwindow[49m[38;5;241;43m=[39;49m[43mwindow[49m[43m,[49m
[1;32m  11700[0m [43m        [49m[43mmin_periods[49m[38;5;241;43m=[39;49m[43mmin_periods[49m[43m,[49m
[1;32m  11701[0m [43m        [49m[43mcenter[49m[38;5;241;43m=[39;49m[43mcenter[49m[43m,[49m
[1;32m  11702[0m [43m        [49m[43mwin_type[49m[38;5;241;43m=[39;49m[43mwin_type[49m[43m,[49m
[1;32m  11703[0m [43m        [49m[43mon[49m[38;5;241;43m=[39;49m[43mon[49m[43m,[49m
[1;32m  11704[0m [43m        [49m[43maxis[49m[38;5;241;43m=[39;49m[43maxis[49m[43m,[49m
[1;32m  11705[0m [43m        [49m[43mclosed[49m[38;5;241;43m=[39;49m[43mclosed[49m[43m,[49m
[1;32m  11706[0m [43m        [49m[43mstep[49m[38;5;241;43m=[39;49m[43mstep[49m[43m,[49m
[1;32m  11707[0m [43m        [49m[43mmethod[49m[38;5;241;43m=[39;49m[43mmethod[49m[43m,[49m
[1;32m  11708[0m [43m    [49m[43m)[49m
[1;32m  11710[0m [38;5;28;01mreturn[39;00m Rolling(
[1;32m  11711[0m     [38;5;28mself[39m,
[1;32m  11712[0m     window[38;5;241m=[39mwindow,
[0;32m   (...)[0m
[1;32m  11720[0m     method[38;5;241m=[39mmethod,
[1;32m  11721[0m )

File [0;32m~/mambaforge/envs/jupyterbook/lib/python3.11/site-packages/pandas/core/window/rolling.py:160[0m, in [0;36mBaseWindow.__init__[0;34m(self, obj, window, min_periods, center, win_type, axis, on, closed, step, method, selection)[0m
[1;32m    154[0m     [38;5;28;01mraise[39;00m [38;5;167;01mValueError[39;00m(
[1;32m    155[0m         [38;5;124mf[39m[38;5;124m"[39m[38;5;124minvalid on specified as [39m[38;5;132;01m{[39;00m[38;5;28mself[39m[38;5;241m.[39mon[38;5;132;01m}[39;00m[38;5;124m, [39m[38;5;124m"[39m
[1;32m    156[0m         [38;5;124m"[39m[38;5;124mmust be a column (of DataFrame), an Index or None[39m[38;5;124m"[39m
[1;32m    157[0m     )
[1;32m    159[0m [38;5;28mself[39m[38;5;241m.[39m_selection [38;5;241m=[39m selection
[0;32m--> 160[0m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_validate[49m[43m([49m[43m)[49m

File [0;32m~/mambaforge/envs/jupyterbook/lib/python3.11/site-packages/pandas/core/window/rolling.py:1138[0m, in [0;36mWindow._validate[0;34m(self)[0m
[1;32m   1136[0m [38;5;28;01mif[39;00m [38;5;129;01mnot[39;00m [38;5;28misinstance[39m([38;5;28mself[39m[38;5;241m.[39mwin_type, [38;5;28mstr[39m):
[1;32m   1137[0m     [38;5;28;01mraise[39;00m [38;5;167;01mValueError[39;00m([38;5;124mf[39m[38;5;124m"[39m[38;5;124mInvalid win_type [39m[38;5;132;01m{[39;00m[38;5;28mself[39m[38;5;241m.[39mwin_type[38;5;132;01m}[39;00m[38;5;124m"[39m)
[0;32m-> 1138[0m signal [38;5;241m=[39m [43mimport_optional_dependency[49m[43m([49m
[1;32m   1139[0m [43m    [49m[38;5;124;43m"[39;49m[38;5;124;43mscipy.signal[39;49m[38;5;124;43m"[39;49m[43m,[49m[43m [49m[43mextra[49m[38;5;241;43m=[39;49m[38;5;124;43m"[39;49m[38;5;124;43mScipy is required to generate window weight.[39;49m[38;5;124;43m"[39;49m
[1;32m   1140[0m [43m[49m[43m)[49m
[1;32m   1141[0m [38;5;28mself[39m[38;5;241m.[39m_scipy_weight_generator [38;5;241m=[39m [38;5;28mgetattr[39m(signal, [38;5;28mself[39m[38;5;241m.[39mwin_type, [38;5;28;01mNone[39;00m)
[1;32m   1142[0m [38;5;28;01mif[39;00m [38;5;28mself[39m[38;5;241m.[39m_scipy_weight_generator [38;5;129;01mis[39;00m [38;5;28;01mNone[39;00m:

File [0;32m~/mambaforge/envs/jupyterbook/lib/python3.11/site-packages/pandas/compat/_optional.py:145[0m, in [0;36mimport_optional_dependency[0;34m(name, extra, errors, min_version)[0m
[1;32m    143[0m [38;5;28;01mexcept[39;00m [38;5;167;01mImportError[39;00m:
[1;32m    144[0m     [38;5;28;01mif[39;00m errors [38;5;241m==[39m [38;5;124m"[39m[38;5;124mraise[39m[38;5;124m"[39m:
[0;32m--> 145[0m         [38;5;28;01mraise[39;00m [38;5;167;01mImportError[39;00m(msg)
[1;32m    146[0m     [38;5;28;01mreturn[39;00m [38;5;28;01mNone[39;00m
[1;32m    148[0m [38;5;66;03m# Handle submodules: if we have submodule, grab parent module from sys.modules[39;00m

[0;31mImportError[0m: Missing optional dependency 'scipy.signal'. Scipy is required to generate window weight. Use pip or conda to install scipy.signal.
ImportError: Missing optional dependency 'scipy.signal'. Scipy is required to generate window weight. Use pip or conda to install scipy.signal.

